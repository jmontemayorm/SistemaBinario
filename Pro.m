clc
clear all
syms E(n,v) F(n,v) E3(n,v)
syms F(n,v) F5(n,v) F6(n,v) F7(n,v)
syms theta0 t0
eul = eulergamma;
%--------------------------------------------------------------------------------------%
%Definimos las funciones de los polinomios a evaluar.
%--------------------------------------------------------------------------------------%
E3(n)=-1*(((675)/(64))-(((34445)/(576))-((205*pi^(2))/(96)))*n+...
    ((155)/(96))*n^(2)+((35)/(5186))*n^(3));
F5(n)=-1*(((8191)/(672))+((583)/(24))*n)*pi;
F6(n)=((6643739519)/(69854400))+((16)/(3))*pi^(2)-((1712)/(105))*eul+(((41)/(48))...
    *pi^(2)-((134543)/(7776)))*n-((94403)/(3024))*n^(2)-...
    ((775)/(324))*n^(3)-((856)/(105))*log(16*v^(2));
F7(n)=-1*(((16285)/(504))-((214754)/(1728))*n-((193385)/(3024))*n^(2))*pi;
E(n,v)=(-1)/(2)*n*v^(2)*[1-((3)/(4)),0,((1)/(12))*n,-1* ...
    (((27)/(8))-((19)/(8))*n+((1)/(24))*n^(2)),0,E3];
F(n,v)=((32)/(5))*n^(2)*v^(10)*[1,-1*(((1247)/(336))+((35)/(12))*n),-4*pi,F5,F6,F7];
%--------------------------------------------------------------------------------------%
%Con poly2sym sacamos los coeficientes del polynomio y con diff lo
%diferenciamos, luego hacemos la dividision de E y F. 
%--------------------------------------------------------------------------------------%
Ec(n,v) = poly2sym(fliplr(E(n,v)),v);
E1(n,v)=diff(Ec,v);
Eco=[0,0,coeffs(E1(n,v),v)];
una=Eco./F
unas=poly2sym(fliplr(una),v);
plot(1:0.1:100,unas(1,1:0.1:100))

F1(n,v) = poly2sym(fliplr(F(n,v)),v);
thet(n,v)=E1(n,v)/F1(n,v);
plot(0:0.1:100,thet(1,0:0.1:100))
thetc=coeffs(thet(n,v),v)
%--------------------------------------------------------------------------------------%
%Integramos el polynomio y lo volvemos a su forma de funcion de nuevo.
%--------------------------------------------------------------------------------------%
theta1=polyint(thetc,v)
t(n,v)=poly2sym(theta1(n,v),v)+t0;
%--------------------------------------------------------------------------------------%
%Se invierte la expansion de t en función de v para obtener v en función de
%t.
%--------------------------------------------------------------------------------------%
Vr=0:0.1:1000;
Tr=t(n,xr);
vt = polyfit(Tr,Vr,7);
syms t
vt1(n,t) = poly2sym(vt,t);
%--------------------------------------------------------------%
